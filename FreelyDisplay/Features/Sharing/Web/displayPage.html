<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>__PAGE_TITLE__</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        .title-bar {
            background-color: #f0f0f0;
            padding: 1rem;
            text-align: center;
            border-bottom: 1px solid #ddd;
        }
        
        .title-bar h1 {
            font-size: 1.8rem;
            color: #333;
        }
        .image-container {
            width: 100%;
            padding: 1rem;
            text-align: center;
        }
        .responsive-image {
            max-width: 100%;
            height: auto;
            display: inline-block;
        }
        .status {
            margin-top: 0.75rem;
            color: #b03a2e;
            font-size: 1rem;
            display: none;
        }
        .retry-button {
            margin-top: 0.75rem;
            border: 1px solid #666;
            background: white;
            border-radius: 8px;
            padding: 0.45rem 0.8rem;
            cursor: pointer;
            display: none;
        }
    </style>
</head>
<body>
    <div class="title-bar">
        <h1 id="pageTitle">__PAGE_TITLE__</h1>
    </div>
    <div class="image-container">
        <img src="__STREAM_PATH__" alt="display" class="responsive-image" id="display">
        <p class="status" id="status">Sharing has stopped</p>
        <button class="retry-button" id="retry" type="button">Retry connection</button>
    </div>
    <script>
        const displayImage = document.getElementById("display");
        const pageTitle = document.getElementById("pageTitle");
        const defaultTitle = "__PAGE_TITLE__";
        const streamPath = "__STREAM_PATH__";
        const status = document.getElementById("status");
        const retry = document.getElementById("retry");
        const lang = navigator.language && navigator.language.toLowerCase().startsWith("zh") ? "zh-Hans" : "en";

        const i18n = {
            en: {
                title: "Display",
                statusStopped: "Sharing has stopped",
                retry: "Retry connection"
            },
            "zh-Hans": {
                title: "屏幕共享",
                statusStopped: "共享已停止",
                retry: "重试连接"
            }
        };

        function applyLocale() {
            const text = i18n[lang] || i18n.en;
            document.documentElement.lang = lang;
            document.title = defaultTitle;
            pageTitle.textContent = defaultTitle;
            status.textContent = text.statusStopped;
            retry.textContent = text.retry;
            displayImage.alt = defaultTitle;
        }

        function updateState(stopped) {
            status.style.display = stopped ? "block" : "none";
            retry.style.display = stopped ? "inline-block" : "none";
            displayImage.style.display = stopped ? "none" : "inline-block";
        }

        function reloadStream() {
            updateState(false);
            displayImage.src = `${streamPath}?t=${Date.now()}`;
        }

        displayImage.addEventListener("load", () => updateState(false));
        displayImage.addEventListener("error", () => updateState(true));
        retry.addEventListener("click", reloadStream);
        applyLocale();
    </script>
</body>
</html>
